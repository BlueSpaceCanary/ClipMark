Hm, interesting problem indeed. My initial thought is, like you mentioned, that you need a richer set of case classes. Maybe you could also track the scene most recently parsed and associate that with the information? I'm not completely sure how you're parsing everything however.

The semantics looks really good. Good use of foreach's in the second pass.

As I discussed with Tyler this week, an important thing to figure out at this point is how you want the final output to look. Additionally, is your target audience programmers or writers? That may affect how you display the information.

Overall, cool looking project! I'd definitely like to talk more with you about the details of the project.
